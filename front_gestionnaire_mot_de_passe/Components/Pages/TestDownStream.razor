@page "/register"
@rendermode InteractiveServer
@using Microsoft.Identity.Abstractions
@inject IDownstreamApi DownstreamApi

<h3>Inscription (POST /Users/RegisterUser)</h3>

<button class="btn btn-primary" @onclick="Register">Lancer le POST</button>

<p>@_status</p>

@code {
    private string? _status;

    private async Task Register()
    {
        try
        {
            var response = await DownstreamApi.CallApiForUserAsync(
                "DownstreamApi",
                options =>
                {
                    options.RelativePath = "/Users/RegisterUser";
                    options.HttpMethod   = "POST"; // string en v4.x
                    // options.Body = new { ... }; // si l’endpoint attend un JSON
                    // options.Headers["Content-Type"] = "application/json";
                });

            _status = $"{(int)response.StatusCode} {response.ReasonPhrase}";
        }
        catch (HttpRequestException ex)
        {
            _status = $"HTTP error: {ex.StatusCode} — {ex.Message}";
        }
        catch (Exception ex)
        {
            _status = $"Erreur: {ex.Message}";
        }
    }
}